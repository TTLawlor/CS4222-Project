
import java.util.LinkedList ;
import java.io.* ;
import java.util.*;
public class WordSearchPuzzle {
    
    private char[][] puzzle;
    char[][] wordPuzzle;
    private List<String> puzzleWords; 
    List<String> wordDirection = new ArrayList<String>();
    List<String> position = new ArrayList<String>();
    List<String> words = new ArrayList<String>();
    //Set<String> words = new HashSet<String>();
    int dimensions;
    int length = 0;
    double sum;
    char randomDirection;
    public WordSearchPuzzle(List<String> userSpecifiedWords) {
         puzzleWords = new ArrayList<>();
         for(int i = 0; i < userSpecifiedWords.size(); i++)  {
             puzzleWords.add(userSpecifiedWords.get(i));
         }
            
            
         for(String str : puzzleWords) {
             length = length + str.length();
         }
         sum = length*1.75;
         dimensions = (int)Math.ceil(Math.sqrt(sum));
         System.out.println("Dimensions = " + dimensions);
            
    }
    
    
    public WordSearchPuzzle(String wordFile, int wordCount,
                              int shortest, int longest)      {
        // puzzle generation using words from a file
        // The user supplies the filename. In the file 
        // the words should appear one per line.
        // The wordCount specifies the number of words
        // to (randomly) select from the file for use in
        // the puzzle.
        // shortest and longest specify the shortest
        // word length to be used and longest specifies
        // the longest word length to be used.
        // SO, using the words in the file randomly select
        // wordCount words with lengths between shortest
        // and longest.
        
        try {
            FileReader aFileReader = new FileReader(wordFile);
            BufferedReader aBufferReader = new BufferedReader(aFileReader);
            String aWord;
            int wordsRead = 0;
            // Use a LinkedList while we are reading the words from the file
            
            LinkedList<String> chosenWords = new LinkedList<String>();
            aWord = aBufferReader.readLine() ;
            while (aWord != null) {
                wordsRead++;
                if(aWord.length() <= longest && aWord.length() >= shortest) {
                    chosenWords.add(aWord.toUpperCase());
                    
                }
                aWord = aBufferReader.readLine() ;
            }
            aBufferReader.close();
            aFileReader.close();
            // Now transfer the words in the LinkedList to an ArrayList
            for(int i = 0; i < wordCount; i++)  {
                int random = (int)(Math.random()*chosenWords.size());
                words.add(chosenWords.get(random).toUpperCase());
                chosenWords.remove(random);
            }
            System.out.println(words);
        }
        catch(IOException x) {
            System.out.println("Error accessing input file!");
        }
        puzzleWords = new ArrayList<>();
         for(int i = 0; i < words.size(); i++)  {
             puzzleWords.add(words.get(i));
         }
            
            
         for(String str : puzzleWords) {
             length = length + str.length();
         }
         sum = length*1.75;
         dimensions = (int)Math.ceil(Math.sqrt(sum));
         System.out.println("Dimensions = " + dimensions);
    }

     
    public List<String> getWordSearchList(){
          System.out.println(puzzleWords);
          return puzzleWords;
    }
      
    
    public char[][] getPuzzleAsGrid(){
          String alphabet = "abcdefghijklmnopqrstuvwxyz";
          puzzle = new char[dimensions][dimensions];
          
          for(int r = 0; r < dimensions; r++){
             for(int c = 0; c < dimensions; c++){
                 int random = (int)(Math.random()* alphabet.length());
                 puzzle[r][c] = alphabet.toUpperCase().charAt(random);
                 System.out.print(puzzle[r][c] + " ");   
             }
             System.out.println();   
          }
            
          return puzzle;
    }
    
    
    public String getPuzzleAsString(){
         char[] arr = new char[dimensions];
         String puzzleAsString = "";
         for(int r = 0; r < dimensions; r++){
             //puzzleAsString = puzzleAsString + Arrays.toString(puzzle[r]) + "\n";
             puzzleAsString = puzzleAsString + String.valueOf(puzzle[r]) + "\n";
         }
         System.out.print(puzzleAsString);
         return puzzleAsString;
    }
        
    
       
    public void generateWordSearchPuzzle(){
        Collections.sort(puzzleWords);
        String direction = "UDLR";
        int i, j, r, c, random, randomRow, randomCol, spaces, row, col;
        
        wordPuzzle = new char[dimensions][dimensions];
        char randomDirection;
        boolean found = false;
        
        for(r = 0; r < dimensions; r++){
           for(c = 0; c < dimensions; c++){
              wordPuzzle[r][c] = ' ';
           }
        }
         
            
        for(j = 0; j < puzzleWords.size(); j++){ 
           
           String word = puzzleWords.get(j).toUpperCase();
           random = (int)(Math.random()*direction.length());
           randomDirection = direction.charAt(random);
           
           if(randomDirection == 'U'){
               int maxBoundaries = dimensions - word.length();
               randomCol = (int)(Math.random()*dimensions);
               randomRow = (int)(Math.random()*maxBoundaries + word.length()-1);
               wordDirection.add("Up");
               
               do{
                   for (spaces = 0; spaces < word.length()-1; spaces++){
                       row = randomRow;
                       if (wordPuzzle[row][randomCol] == ' ' && row < word.length()){
                           row--;
                       }else{
                           spaces = 0; 
                       }
                   } 
                   if(spaces == word.length()-1){
                       found = true;
                   }else{
                        randomCol = (int)(Math.random()*dimensions);
                        randomRow = (int)(Math.random()*maxBoundaries + word.length()-1);
                   }
               }while(false);
               
               position.add(String.valueOf(randomRow) + "," + String.valueOf(randomCol)); 
               
               for(i = 0; i < word.length(); i++){
                   wordPuzzle[randomRow][randomCol] = word.charAt(i);
                   randomRow--;
               }
                   
           } else if(randomDirection == 'D'){
               wordDirection.add("Down");
               
               int maxBoundaries = dimensions - word.length();
               randomCol = (int)(Math.random()*dimensions);
               randomRow = (int)(Math.random()*maxBoundaries);
               
               do{
                    for (spaces = 0; spaces < word.length()-1; spaces++){
                        row = randomRow;
                        if (wordPuzzle[row][randomCol] == ' '){
                           row++;
                        }else{
                           spaces = 0; 
                        }    
                            
                    }   
                    if(spaces == word.length()-1){
                           found = true;
                    }else{
                           randomCol = (int)(Math.random()*dimensions);
                           randomRow = (int)(Math.random()*maxBoundaries);
                    }
               }while(false);
               
               position.add(String.valueOf(randomRow) + "," + String.valueOf(randomCol));
               
                
               for(i = 0; i < word.length(); i++){
                   wordPuzzle[randomRow][randomCol] = word.charAt(i);
                   randomRow++;
                        } 
                    
           } else if(randomDirection == 'R'){
               wordDirection.add("Left to Right");
               
               int maxBoundaries = dimensions - word.length();
               randomCol = (int)(Math.random()*maxBoundaries);
               randomRow = (int)(Math.random()*dimensions);
              
               
               do{
                   for (spaces = 0; spaces < word.length()-1; spaces++){
                       col = randomCol;
                       if (wordPuzzle[randomRow][col] == ' '){
                           col++;
                       }else{
                           spaces = 0; 
                       }    
                          
                   }
                   if(spaces == word.length()-1){
                           found = true;
                       }else{
                           randomCol = (int)(Math.random()*maxBoundaries);
                           randomRow = (int)(Math.random()*dimensions);
                       }
               }while(false);
               position.add(String.valueOf(randomRow) + "," + String.valueOf(randomCol));
               
               for(i = 0; i < word.length(); i++){
                      wordPuzzle[randomRow][randomCol] = word.charAt(i);
                      randomCol++;
               } 
                   
            } else if(randomDirection == 'L'){
                wordDirection.add("Right to Left");
                
                int maxBoundaries = dimensions - word.length();
                randomCol = (int)(Math.random()*maxBoundaries + word.length()-1);
                randomRow = (int)(Math.random()*dimensions);
                
                do{
                    for (spaces = 0; spaces < word.length()-1; spaces++){
                        col = randomCol;
                        if (wordPuzzle[randomRow][col] == ' '){
                            col--;
                        }else{
                            spaces = 0; 
                        }  
                    }
                    if(spaces == word.length()-1){
                            found = true;
                        }else{
                            randomCol = (int)(Math.random()*maxBoundaries + word.length()-1);
                            randomRow = (int)(Math.random()*dimensions);
                        }
                }while(false);
                
                position.add(String.valueOf(randomRow) + "," + String.valueOf(randomCol));
                
                for(i = 0; i < word.length(); i++){
                    wordPuzzle[randomRow][randomCol] = word.charAt(i);
                    randomCol--;
                }
                    
             }
        }
        
        for(r = 0; r < dimensions; r++){
             for(c = 0; c < dimensions; c++){
                if(wordPuzzle[r][c] == ' '){
                 wordPuzzle[r][c] = puzzle[r][c];
                }
                System.out.print(wordPuzzle[r][c] + " ");
             }
             System.out.println();            
          
        }
    }
    
    public void showWordSearchPuzzle(boolean hide){
        Collections.sort(puzzleWords);
        System.out.println("PUZZLE");
        System.out.println("------");
        if(hide == false){
             
             for(int r = 0; r < dimensions; r++){
                for(int c = 0; c < dimensions; c++){
                    System.out.print(wordPuzzle[r][c] + " ");
                }
                 System.out.println();            
             }
             System.out.println();
             
             for(int i = 0; (i < puzzleWords.size()) && (i < wordDirection.size()); i++){ 
                 System.out.print(puzzleWords.get(i).toUpperCase() + " ");
                 System.out.println(position.get(i));
                 System.out.println("Direction: " + wordDirection.get(i) + "\n");
             }
        }else{
            
             for(int r = 0; r < dimensions; r++){
                for(int c = 0; c < dimensions; c++){
                     System.out.print(wordPuzzle[r][c] + " ");
                }
                 System.out.println();            
             }
             
             System.out.println();
             for(int i = 0; i < puzzleWords.size(); i++){ 
                 System.out.println(puzzleWords.get(i).toUpperCase() + randomDirection);
             }
        }
    }
}
